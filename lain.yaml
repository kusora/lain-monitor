appname: tinydns-healthcheck

build:
  base: laincloud/golang:1.8.3
  prepare:
    version: 201708101429
    script:
      - curl https://glide.sh/get | sh
      - mkdir -p $GOPATH/src/github.com/laincloud/tinydns-healthcheck
      - cp -rf . $GOPATH/src/github.com/laincloud/tinydns-healthcheck
      - cd $GOPATH/src/github.com/laincloud/tinydns-healthcheck && glide install
  script:
    - cp -rf . $GOPATH/src/github.com/laincloud/tinydns-healthcheck
    - cd $GOPATH/src/github.com/laincloud/tinydns-healthcheck && go install

release:
  dest_base: laincloud/centos:7.3.1611
  copy:
    - src: $GOPATH/bin/tinydns-healthcheck
      dest: /lain/app/tinydns-healthcheck

proc.server:
  cmd: sleep infinity

web:
  cmd: /lain/app/tinydns-healthcheck
  port: 8080
  healthcheck: /ping
